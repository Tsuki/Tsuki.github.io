<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ツカツキ アリス</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://blog.sukitsuki.com/"/>
  <updated>2019-01-03T08:24:29.711Z</updated>
  <id>https://blog.sukitsuki.com/</id>
  
  <author>
    <name>調月有栖</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>選擇SFP的ONU端口</title>
    <link href="https://blog.sukitsuki.com/2019/01/03/%E9%81%B8%E6%93%87SFP%E7%9A%84ONU%E7%AB%AF%E5%8F%A3/"/>
    <id>https://blog.sukitsuki.com/2019/01/03/選擇SFP的ONU端口/</id>
    <published>2019-01-03T13:36:40.000Z</published>
    <updated>2019-01-03T08:24:29.711Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SFP接口"><a href="#SFP接口" class="headerlink" title="SFP接口"></a>SFP接口</h2><p>現時的路由器/交換器在需要接入光纖的時候，一般需要使用上 SFP 接口。</p><p>SFP 的接口比上一代的 GBIC 接口要小一點，這樣前端面版就可以接入更多的光纖。</p><p>SFP 接口分別有兩種制式，接 1G 或以下的 SFP 接口和接 1G 到 10G 的 SFP+ 接口。</p><p>雖然兩種制式的接口都一樣，但並一定不通用，部分交換機 SFP 接口同時支持兼容 SFP+。</p><h2 id="接口種類"><a href="#接口種類" class="headerlink" title="接口種類"></a>接口種類</h2><p>SFP 接口的種類可以從速率，光波長，傳送距離，光端接口，單模/雙模，單纖雙向(BiDi)/雙纖，端面。</p><h3 id="速率"><a href="#速率" class="headerlink" title="速率"></a>速率</h3><p>按照速率分類：有155M/622M/1.25G/2.125G/4.25G/8G/10G，常見的有155M/1.25G/2.125G/10G。</p><h3 id="波長"><a href="#波長" class="headerlink" title="波長"></a>波長</h3><p>按照波長分類：有850nm/1310nm/1550nm/1490nm/1530nm/1610nm，多模常見的有850nm，單模的有1310nm/1550nm/1490nm。</p><h3 id="傳送距離"><a href="#傳送距離" class="headerlink" title="傳送距離"></a>傳送距離</h3><p>按照傳送距離分類：有5KM/20KM/40KM/80KM/120KM等，</p><h3 id="光端接口"><a href="#光端接口" class="headerlink" title="光端接口"></a>光端接口</h3><p>按照光端接口分類：常見的有SC/LC/FC/ST，</p><ul><li>FC (Ferrule Connector)，金屬接頭對光纖芯提供良好的保護，但它是用旋轉的方式，對光纖芯容易造成刮傷。</li><li>SC (Subscriber Connector / Standard Connector)，接頭主要應用一般固網環境中，提供良好的包裝強度。</li><li>LC (Lucent Connector / Local Connector)，接頭主要應用企業網絡環境中，用來取代SC接頭的，它的尺寸比較小，適合大量佈置。</li><li>ST (Straight Tip)，接頭有防呆卡榫避免接頭損毀，將線插入插座，然後旋轉外面的卡榫將之鎖住。</li></ul><h3 id="單模-雙模"><a href="#單模-雙模" class="headerlink" title="單模/雙模"></a>單模/雙模</h3><ul><li><p>多模光纖(MMF，Multi Mode Fiber)，纖芯較粗，可傳多種模式的光。但其模間色散較大，且隨傳輸距離的增加模間色散情況會逐漸加重。</p></li><li><p>單模光纖(SMF，Single Mode Fiber)，纖芯較細，只能傳一種模式的光。因此，其模間色散很小，適用於遠程通訊。</p></li></ul><h3 id="單纖雙向-BiDi-雙纖雙向"><a href="#單纖雙向-BiDi-雙纖雙向" class="headerlink" title="單纖雙向(BiDi)/雙纖雙向"></a>單纖雙向(BiDi)/雙纖雙向</h3><ul><li><p>單纖雙向，採用了WDM技術，通過一根光纖實現雙向傳輸信號，應用於高性能集成的雙工數據鏈路中，但是需要保證發射和接收的為不同波長的信號。常用光模塊的波長方案為單模1310nm/1550nm、1310nm/1490nm。</p></li><li><p>雙纖雙向，常規的光模塊都是雙纖的，有兩個光纖插孔，而單纖雙向光模塊只有一個插孔，一般的光模塊都需要兩個端口，一個用來發射數據，一個用來接收數據。</p></li></ul><p>單纖BIDI光模塊比較貴，但節省光纖資源，只需要1根光纖，適合家居式網絡 FTTx 等方案。</p><p>雙纖光模塊不需要配對使用，任意兩個光模塊都可以連接，適合企業內聯網方案，方便替換接口，但是需要多用一跟光纖。</p><h3 id="端面"><a href="#端面" class="headerlink" title="端面"></a>端面</h3><ul><li><p>PC (Physical Contact，及物理接觸) 是光纖跳線上光纖連接器最常見的研磨方式，被廣泛應用於電信運營商設備上。雖然光纖連接器端面看似平面，但實際上其端面經過輕微彎曲拋光，且彎曲最高點是纖芯中心，這樣可有效減少光纖組件之間的空氣隙，一般情況下，採用PC研磨方式的光纖跳線的回波損耗為-40dB。</p></li><li><p>UPC (Ultra Physical Contact，即超物理接觸) 是由PC演進而來，它對端面拋光進行了優化，從而獲得了更好的表面光潔度。UPC與PC一樣，其彎曲最高點在光纖芯中心，但UPC回波損耗相對於PC來說更高，一般是在-50dB（甚至更高）。它通常被用於以太網網絡設備上（如ODF光纖配線架、媒體轉換器和光纖交換機等），同時也用於電話系統。</p></li><li><p>APC (Angled Physical Contact，即角度物理接觸) 是光纖端面研磨的最新技術，其端面採用了8度夾角研磨方式，使其端面研磨更加精準，可有效減少反射，回波損耗大約在-60dB。APC一般用於CATV等高波長範圍的光學射頻應用。</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;SFP接口&quot;&gt;&lt;a href=&quot;#SFP接口&quot; class=&quot;headerlink&quot; title=&quot;SFP接口&quot;&gt;&lt;/a&gt;SFP接口&lt;/h2&gt;&lt;p&gt;現時的路由器/交換器在需要接入光纖的時候，一般需要使用上 SFP 接口。&lt;/p&gt;&lt;p&gt;SFP 的接口比上一代的 GB
      
    
    </summary>
    
      <category term="Network" scheme="https://blog.sukitsuki.com/categories/Network/"/>
    
    
  </entry>
  
  <entry>
    <title>當年今日</title>
    <link href="https://blog.sukitsuki.com/2019/01/01/%E7%95%B6%E5%B9%B4%E4%BB%8A%E6%97%A5/"/>
    <id>https://blog.sukitsuki.com/2019/01/01/當年今日/</id>
    <published>2019-01-01T10:54:24.000Z</published>
    <updated>2019-01-01T09:39:25.911Z</updated>
    
    <content type="html"><![CDATA[<iframe width="100%" height="525" src="https://www.youtube.com/embed/URUIcYDq3_I?controls=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p><code>很多時候，選擇並不需要經過多麼理性的思考。</code></p><p><code>困難的其實並非是選擇本身，而是思考選擇的過程。</code></p><p><code>現實不可能如此理想化，因此達成理想的途徑不可能脫離現實。</code></p><p><code>對於現實我們無能為力，我們只能依靠合理的規則使現實不至於脫軌，並且讓現實成為動力。</code></p><p><code>不要試圖以長期的理想去思考解決短期問題的辦法，這是一種妥協。</code></p><p><code>回憶是用以憑吊的，不是用來沈溺的。</code></p><p><code>就算有一天我們都會老去，至少到時我們回憶過去的時候，會為了自己曾經做過的事微笑，這樣就足夠了。</code></p><p>2018 年裹，經歷的事不算太多。但經歷的事算是人生的轉捩點。</p><p>生亦何歡，死亦何苦？如何構成「有意義」的人生，人生的意義在不同時段都有不同的失落，</p><p>對人生的目標，開始思考人生的目標，對自己所追求的目標出現質疑。</p><p>在思考自己人生的意義之前，很多時是被一些社會上客觀的意義支配著，</p><p>如果沒有自我追求，人生不過是社會上的一個配件，因為活著而活著，</p><p>新的一年，希望能為自己而渡過，在生命的道路上留下自己在意的足印。</p><p>在工作和生活上，重新取得平衡，而不是在為生活而工作的壓力下活著。</p><font color="#fff"><br>孩童只盼望歡樂<br>大人只知道寄望<br><br>不要不要假設我知道<br>一切一切也都是為我而做<br><br>霎眼廿七歲　時日無多方不敢偷懶<br>宏願縱未了　奮鬥總不太晚<br><br>曾付出幾多心跳<br>來換取一堆堆的發票<br>用我尚有　換我沒有　其實已用盡所擁有<br><br>無須要快樂　反正我一早枯死<br>如果有眼淚　只不過生理分泌<br>如懷念也是有它限期　明日我便記不起<br><br>在有生的瞬間能遇到你　竟花光所有運氣<br>到這日才發現　曾呼吸過空氣</font>]]></content>
    
    <summary type="html">
    
      
      
        &lt;iframe width=&quot;100%&quot; height=&quot;525&quot; src=&quot;https://www.youtube.com/embed/URUIcYDq3_I?controls=0&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Angular/Element(Web Components)</title>
    <link href="https://blog.sukitsuki.com/2018/12/19/Angular-Element-Web-Components/"/>
    <id>https://blog.sukitsuki.com/2018/12/19/Angular-Element-Web-Components/</id>
    <published>2018-12-19T17:39:31.000Z</published>
    <updated>2018-12-19T13:16:13.455Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Web-Components"><a href="#Web-Components" class="headerlink" title="Web Components"></a>Web Components</h2><p>Web Components 是最新的 HTML 技術，這項技術可以令瀏覽器支持原生的自定組件，這種做法就可以減輕對前端的依賴/需求。</p><p>別外，使用 web components 可以代替組件在網頁上 JIT 編譯，減小瀏覽器的壓力。</p><h2 id="在Angular-上使用-Web-Component"><a href="#在Angular-上使用-Web-Component" class="headerlink" title="在Angular 上使用 Web Component"></a>在Angular 上使用 Web Component</h2><h3 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h3><p>首先在項目目錄下安裝 <code>@angular/elements</code></p><p>之後把 <code>document-register-element</code> 更新</p><p>別外，為了支持舊版本的瀏覽器，需要加入兼容器 (polyfill) <code>@webcomponents/webcomponentsjs</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ng add @angular/elements</span><br><span class="line">yarn add document-register-element</span><br><span class="line">yarn add @webcomponents/webcomponentsjs</span><br></pre></td></tr></table></figure><p>之後在 <code>polyfills.ts</code> 載入</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * APPLICATION IMPORTS</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">import '@webcomponents/webcomponentsjs/custom-elements-es5-adapter.js';</span><br></pre></td></tr></table></figure><p>如果有使用 <code>ngx-build-plus</code> 和 <code>html-webpack-plugin</code> , 需要把 html-webpack-plugin 更新到 <code>4.0.0</code>，因為</p><p><a href="https://github.com/angular/angular-cli/issues/13223" target="_blank" rel="noopener">https://github.com/angular/angular-cli/issues/13223</a></p><p>使用 <code>custom-elements-es5-adapter</code> 是因為 Angular/Elements 不能在 <code>tsconfig.json</code> 降級到 ES5 來支持 IE/Edge，必須使用 ES2015 不然 Chrome 會報錯，所以使用這個庫來達成兼容。</p><p>使用 <code>webcomponents-bundle.js</code> 是為了兼容不支持 web components 的瀏覽器，別外一個是使用 <code>webcomponents-loader.js</code> 進行懶加庫所需要的庫。</p><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>由於 <a href="https://github.com/webcomponents/webcomponentsjs/issues/909" target="_blank" rel="noopener">https://github.com/webcomponents/webcomponentsjs/issues/909</a> 不能在 polyfill.ts 裹加入</p><p><code>import webcomponents-bundle.js</code>，所以需要在 <code>angular.json</code> 的 script 載入。</p><p>如果要使用 <code>webcomponents-loader.js</code> 需要在 <code>angular.json</code> 的 asset 下加入 webcomponentsjs 的bundle 到 asset。</p><p>因為 load 是使用 <code>document.querySelector(&#39;script[src*=&quot;webcomponents-loader.js&quot;]&#39;)</code> 再進行 replace。</p><p>使用時， <code>angular.json</code> 需要在把 script 顯式加入</p><p><code>&quot;bundleName&quot;: &quot;webcomponents-loader&quot;,&quot;lazy&quot;: true</code></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">"assets": [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"glob"</span>: <span class="string">"**/*"</span>,</span><br><span class="line">    <span class="attr">"input"</span>: <span class="string">"node_modules/@webcomponents/webcomponentsjs/bundles"</span>,</span><br><span class="line">    <span class="attr">"output"</span>: <span class="string">"./bundles"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  "src/favicon.ico",</span><br><span class="line">  <span class="string">"src/assets"</span></span><br><span class="line">],</span><br><span class="line">....</span><br><span class="line">"scripts": [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"input"</span>: <span class="string">"node_modules/document-register-element/build/document-register-element.js"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">  <span class="attr">"input"</span>: <span class="string">"node_modules/@webcomponents/webcomponentsjs/webcomponents-bundle.js"</span>,      </span><br><span class="line">  &#125;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"input"</span>: <span class="string">"node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"</span>,</span><br><span class="line">    <span class="attr">"bundleName"</span>: <span class="string">"webcomponents-loader"</span>,</span><br><span class="line">    <span class="attr">"lazy"</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h2 id="組件"><a href="#組件" class="headerlink" title="組件"></a>組件</h2><h3 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h3><p>在需要 web components 的組件下加入或修改 <code>encapsulation: ViewEncapsulation.ShadowDom</code>。</p><p>Ps: <code>ViewEncapsulation.Native</code> 在 Angular 6.1.0 己經被標記為棄用，</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-picture'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./picture.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./picture.component.styl'</span>],</span><br><span class="line">  encapsulation: ViewEncapsulation.ShadowDom</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> PictureComponent</span><br></pre></td></tr></table></figure><h3 id="載入"><a href="#載入" class="headerlink" title="載入"></a>載入</h3><p>要使模板上使用 web components，需要在 <code>AppModule.ts</code> 的載入組件和組件的元素名。</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule <span class="keyword">implements</span> DoBootstrap &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> faIconService: FaIconService, <span class="keyword">private</span> injector: Injector</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> customButton = createCustomElement(PictureComponent, &#123;injector: <span class="keyword">this</span>.injector&#125;);</span><br><span class="line">    customElements.define(<span class="string">'nat-picture'</span>, &lt;<span class="built_in">Function</span>&gt;customButton);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ngDoBootstrap(appRef: ApplicationRef): <span class="built_in">void</span> &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Web-Components&quot;&gt;&lt;a href=&quot;#Web-Components&quot; class=&quot;headerlink&quot; title=&quot;Web Components&quot;&gt;&lt;/a&gt;Web Components&lt;/h2&gt;&lt;p&gt;Web Components 是最新的 HT
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>在Angular動態加載html</title>
    <link href="https://blog.sukitsuki.com/2018/12/17/%E5%9C%A8Angular%E5%8B%95%E6%85%8B%E5%8A%A0%E8%BC%89html/"/>
    <id>https://blog.sukitsuki.com/2018/12/17/在Angular動態加載html/</id>
    <published>2018-12-17T19:21:15.000Z</published>
    <updated>2018-12-18T07:34:52.135Z</updated>
    
    <content type="html"><![CDATA[<h3 id="原生靜態-HTML"><a href="#原生靜態-HTML" class="headerlink" title="原生靜態 HTML"></a>原生靜態 HTML</h3><p>使用 <code>innerHtml</code> 直接取代原生 element.</p><p>但如果 HTML 內有 inline style 或 sciprt, 這就需要 <code>DomSanitizer</code> 進行 <code>bypassSecurityTrustHtml</code>.</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Pipe, PipeTransform&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;DomSanitizer&#125; <span class="keyword">from</span> <span class="string">"@angular/platform-browser"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pipe</span>(&#123;</span><br><span class="line">  name: <span class="string">'safeHtml'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> SafeHtmlPipe <span class="keyword">implements</span> PipeTransform &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> sanitizer: DomSanitizer</span>) &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  transform(value: <span class="built_in">any</span>, args?: <span class="built_in">any</span>): <span class="built_in">any</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.sanitizer.bypassSecurityTrustHtml(value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">innerHtml</span>]=<span class="string">"post.content|safeHtml"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="非原生-HTML"><a href="#非原生-HTML" class="headerlink" title="非原生 HTML"></a>非原生 HTML</h3><p>首先，建立 helper function，以幫助構建 <code>Component</code> 和 <code>Module</code></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">compileToComponent</span>(<span class="params">template</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Component(&#123;template&#125;)(<span class="keyword">class</span> &#123;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">compileToModule</span>(<span class="params">declarations, imports?</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> NgModule(&#123;declarations, imports&#125;)(<span class="keyword">class</span> &#123;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>之後使用 <code>ViewChild</code> 綁定 <code>ng-template</code> ，最後在 <code>ngAfterViewInit</code> 使用 JITcompile 進行實時編譯並在生成組件。</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> PostBodyComponent <span class="keyword">implements</span> OnInit, AfterViewInit &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@ViewChild</span>(<span class="string">'container'</span>, &#123;read: ViewContainerRef&#125;)</span><br><span class="line">  container: ViewContainerRef;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> compiler: Compiler</span>) &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ngOnInit() &#123;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ngAfterViewInit(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> tmpComponent = compileToComponent(<span class="keyword">this</span>.post.content);</span><br><span class="line">    <span class="keyword">const</span> tmpModule = compileToModule([tmpComponent], [AppModule]);</span><br><span class="line">    <span class="keyword">this</span>.compiler.compileModuleAndAllComponentsAsync(tmpModule).then(</span><br><span class="line">      (factories) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> factory = factories.componentFactories.find(<span class="function"><span class="params">f</span> =&gt;</span> f.componentType === tmpComponent);</span><br><span class="line">        <span class="keyword">this</span>.container.createComponent(factory);</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ng-template</span> #<span class="attr">container</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>由於 Angular 4 之後 AoT 和 Jit 不能並存，所以需要在 <code>angular.json</code> 關閉 aot 和 buildOptimizer。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">"configurations": &#123;</span><br><span class="line">  "production": &#123;</span><br><span class="line">    ...</span><br><span class="line">    "aot": false,</span><br><span class="line">    "buildOptimizer": false,</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;原生靜態-HTML&quot;&gt;&lt;a href=&quot;#原生靜態-HTML&quot; class=&quot;headerlink&quot; title=&quot;原生靜態 HTML&quot;&gt;&lt;/a&gt;原生靜態 HTML&lt;/h3&gt;&lt;p&gt;使用 &lt;code&gt;innerHtml&lt;/code&gt; 直接取代原生 element.&lt;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>PSV變革</title>
    <link href="https://blog.sukitsuki.com/2018/12/17/PSV%E8%AE%8A%E9%9D%A9/"/>
    <id>https://blog.sukitsuki.com/2018/12/17/PSV變革/</id>
    <published>2018-12-17T10:48:17.000Z</published>
    <updated>2018-12-17T05:31:42.346Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Make-PSV-great-again"><a href="#Make-PSV-great-again" class="headerlink" title="Make PSV great again"></a>Make PSV great again</h1><p>HENkaku (變革) 令 PSV 如同 PSP 時代一樣強大起來。</p><h2 id="準備"><a href="#準備" class="headerlink" title="準備"></a>準備</h2><p>一台 PSV，如果是 PSV 1000 需要額外的 Sony 記憶卡（因為 1000 沒有內部儲存空間</p><h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><p>由於變革不是永久性/固化的漏洞（），因此只支持版本 3.65 ~ 3.68 ，如果己升級到 3.69 下文就不再適用。</p><p>如果版本在 3.65 以下，可以使用修改 DNS 方法更新，比如 <code>23.96.6.207</code> ，修改之後更新包會變成 <code>3.65 (変革 Compatible)</code> 。</p><h2 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h2><h3 id="Windows-用戶"><a href="#Windows-用戶" class="headerlink" title="Windows 用戶"></a>Windows 用戶</h3><p>如果使用 Windows 安裝，只需要下載 <a href="https://github.com/noahc3/auto-h-encore" target="_blank" rel="noopener">auto h-encore</a> 就可以完成大部分前置準備工作，自動下載 QCMA，DEOM，解包，修改包內容，重新打包等工作。</p><p>打開 auto h-encore 只需要點 start 等待下載完成所需工具後，會提示安裝 QCMA，建意便用 USB 驅動安裝。</p><p>安裝好 QCMA 後，會自動進行置換DEOM包的工具，完成之後打開 OCMA 工具 並接上 PSV USB到電腦。</p><p>其後在 PSV 打開內容管理，選 USB 傳輸，再記 PC 到 PSV，最後把打包好的 h-encore 傳到PSV上。</p><h3 id="macOS-Linux-用戶"><a href="#macOS-Linux-用戶" class="headerlink" title="macOS/Linux 用戶"></a>macOS/Linux 用戶</h3><p>使用 <a href="https://github.com/soarqin/finalhe" target="_blank" rel="noopener">finalhe</a> ，因為沒使用過，就不詳細說了。</p><h2 id="變革"><a href="#變革" class="headerlink" title="變革"></a>變革</h2><p>在 Live Area 下打開 H-encore，進入 bootstrap menu, 之後在菜單上選擇 Install HENkaku。</p><p>完成之後，強烈建意安裝，選擇 <code>Download VitaShell</code>（需要WI-FI連網），因為很多情況下都需要使用上。</p><p>最後，回到 <code>Exit</code> 退回 Live Area，之後打開設定，菜單上會多了一項 HENkaku 設置，進入後啟動 <strong>啟動不安全自制軟件</strong>。</p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><ul><li><a href="https://github.com/TheOfficialFloW/NoNpDrm/releases" target="_blank" rel="noopener">NoNpDrm</a> <em>(允許使用已加密的遊戲及應用程式)</em></li><li><a href="https://github.com/Applelo/SwitchSD2Vita/releases" target="_blank" rel="noopener">SwitchSD2Vita</a> <em>(使用 sd2vita 卡帶代替Sony 記憶卡)</em></li><li><a href="https://github.com/blastrock/pkgj/releases" target="_blank" rel="noopener">PKGj</a> <em>(提供網上下載 PSV PSP PSX PSM遊戲/ PSV DLC功能)</em></li><li><a href="https://github.com/ONElua/AccountManager/releases" target="_blank" rel="noopener">AccountManager</a> (提供備分轉換 PSV 內的 PSN 功能)</li></ul><p>以上除了 NoNpDrm 都是使用 vpk 格式安裝，只需要在 VITAShell 下點選安裝就可以。</p><h3 id="NoNpDrm"><a href="#NoNpDrm" class="headerlink" title="NoNpDrm"></a>NoNpDrm</h3><p>NoNpDrm安裝，需要在 VITAShell 下打開並修改 <code>ux0:tai/config.txt</code> ，</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*KERNEL</span><br><span class="line">ux0:tai/nonpdrm.skprx</span><br></pre></td></tr></table></figure><p>之後保存重啟 PSV，再重新進了 h-encore，之後 Exit, 不需要再選擇 <code>Install HENkaku</code></p><p>###AccountManager</p><p>轉換帳號前，盡可能先保存當前帳號 ，之到 <code>HENkaku 設置</code> 解除記憶卡/內存綁定，或使用 <code>VITAShell</code> 在 ur0 或 uma0 下刪除 id.dat。不然換轉帳號後不能讀取記憶卡/內存上的 H-encore 引導。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Make-PSV-great-again&quot;&gt;&lt;a href=&quot;#Make-PSV-great-again&quot; class=&quot;headerlink&quot; title=&quot;Make PSV great again&quot;&gt;&lt;/a&gt;Make PSV great again&lt;/h1&gt;&lt;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Angular-起動時加入Async和defer</title>
    <link href="https://blog.sukitsuki.com/2018/12/15/Angular-%E8%B5%B7%E5%8B%95%E6%99%82%E5%8A%A0%E5%85%A5async%E5%92%8Cdefer/"/>
    <id>https://blog.sukitsuki.com/2018/12/15/Angular-起動時加入async和defer/</id>
    <published>2018-12-15T13:40:11.000Z</published>
    <updated>2018-12-18T07:34:52.135Z</updated>
    
    <content type="html"><![CDATA[<p>首先，在 Angular 不 Eject 的情況下，使用其他的 Webpack plugin，這樣需要引入 ngx-build-plus。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install ngx-build-plus</span><br></pre></td></tr></table></figure><p>之後在 angular.json 替換 angular-cli 本來的引導指令</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">  <span class="string">"architect"</span>: &#123;</span><br><span class="line">    <span class="string">"build"</span>: &#123;</span><br><span class="line">      <span class="string">"builder"</span>: <span class="string">"ngx-build-plus:build"</span>,</span><br><span class="line">      ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="string">"serve"</span>: &#123;</span><br><span class="line">       <span class="string">"builder"</span>: <span class="string">"ngx-build-plus:dev-server"</span>,</span><br><span class="line">       ...</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>別外，在目錄下加入額外的 Webpack 配置文件 <code>webpack.extra.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> ScriptExtHtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'script-ext-html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> METADATA = &#123;</span><br><span class="line">  baseUrl: <span class="string">'/'</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: <span class="string">'src/index.html'</span>,</span><br><span class="line">      chunks: [<span class="string">'styles'</span>, <span class="string">'runtime'</span>, <span class="string">'polyfills'</span>, <span class="string">'main'</span>],</span><br><span class="line">      chunksSortMode: <span class="string">'manual'</span>,</span><br><span class="line">      metadata: METADATA,</span><br><span class="line">      inject: <span class="string">'head'</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> ScriptExtHtmlWebpackPlugin(&#123;</span><br><span class="line">      defaultAttribute: <span class="string">'defer'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>~~ 由於 Angular 的 <code>zone.js</code> 需要比其他的 js 先載入，所以 polyfills 使用 <code>async</code>，而其他使用 <code>defer</code></p><p>這樣配置就可以把 <code>polyfills.js</code> 以外的 script 都加上 <code>defer</code> 屬性。~~</p><p>把 <code>chunksSortMode</code> 改成 manual, 這樣就會按 <code>chunks</code> 的排序。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"ng build --prod --extraWebpackConfig webpack.extra.js"</span>,</span><br><span class="line">...</span><br><span class="line">&#125;,</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>最後修改 <code>package.json</code> 的 <code>build</code></p><p><a href="https://github.com/angular/angular-cli/blob/master/packages/angular_devkit/build_angular/src/angular-cli-files/plugins/index-html-webpack-plugin.ts" target="_blank" rel="noopener">Angular 官方配置</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;首先，在 Angular 不 Eject 的情況下，使用其他的 Webpack plugin，這樣需要引入 ngx-build-plus。&lt;/p&gt;&lt;figure class=&quot;highlight sh&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>主題遷移到 Angular 進度</title>
    <link href="https://blog.sukitsuki.com/2018/12/10/%E4%B8%BB%E9%A1%8C%E9%81%B7%E7%A7%BB%E5%88%B0-Angular-%E9%80%B2%E5%BA%A6/"/>
    <id>https://blog.sukitsuki.com/2018/12/10/主題遷移到-Angular-進度/</id>
    <published>2018-12-10T16:27:32.000Z</published>
    <updated>2018-12-19T13:16:13.455Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安格拉絲-Angular"><a href="#安格拉絲-Angular" class="headerlink" title="安格拉絲 / Angular"></a>安格拉絲 / Angular</h1><blockquote><p>大紮好，我系 <a href="https://github.com/Tsuki/" target="_blank" rel="noopener">Tsuki</a>，安格拉絲，介四里沒有挽過的船新版本，擠需體驗三番鍾，里造會幹我一樣，愛象節款框架。</p></blockquote><p>進度</p><ul><li style="list-style:none"><input type="checkbox" checked> Header (完成)</li><li style="list-style:none"><input type="checkbox" checked> Pages (完成)</li><li style="list-style:none"><input type="checkbox" checked> Article (完成)</li><li style="list-style:none"><input type="checkbox" checked> Header 動畫 (完成)</li><li style="list-style:none"><input type="checkbox" checked> Pages 動畫 (完成)</li><li style="list-style:none"><input type="checkbox" checked> Footer (完成)</li><li style="list-style:none"><input type="checkbox" checked> Article 前後頁</li><li style="list-style:none"><input type="checkbox" checked> Markdown Todo-list</li><li style="list-style:none"><input type="checkbox" checked> Post page</li><li style="list-style:none"><input type="checkbox"> mobile</li><li style="list-style:none"><input type="checkbox"> Cate/Tag/Arcivee</li><li style="list-style:none"><input type="checkbox"> Side menu</li><li style="list-style:none"><input type="checkbox"> APlayer</li><li style="list-style:none"><input type="checkbox"> 優化 moment.js</li><li style="list-style:none"><input type="checkbox"> 動態注入配置</li><li style="list-style:none"><input type="checkbox"> 評論數</li><li style="list-style:none"><input type="checkbox"> FancyBox 效果</li><li style="list-style:none"><input type="checkbox"> Article 置頂跑馬燈</li><li style="list-style:none"><input type="checkbox"> Badge count</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;安格拉絲-Angular&quot;&gt;&lt;a href=&quot;#安格拉絲-Angular&quot; class=&quot;headerlink&quot; title=&quot;安格拉絲 / Angular&quot;&gt;&lt;/a&gt;安格拉絲 / Angular&lt;/h1&gt;&lt;blockquote&gt;&lt;p&gt;大紮好，我系 &lt;a href
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>如何把頁眉(Header)置頂</title>
    <link href="https://blog.sukitsuki.com/2018/11/29/%E5%A6%82%E4%BD%95%E6%8A%8A%E9%A0%81%E7%9C%89-header-%E7%BD%AE%E9%A0%82/"/>
    <id>https://blog.sukitsuki.com/2018/11/29/如何把頁眉-header-置頂/</id>
    <published>2018-11-29T14:59:03.000Z</published>
    <updated>2018-11-29T08:23:17.100Z</updated>
    
    <content type="html"><![CDATA[<h3 id="方案一：兼容IE"><a href="#方案一：兼容IE" class="headerlink" title="方案一：兼容IE"></a>方案一：兼容IE</h3><p>這個方案並不完美，position: fixed 太多坑，如果有有別一個 position: fixed 會出現奇怪的問題。</p><p>現在頁面改成下面的方案二，雖然不支持IE，但減少了JS 代碼，而且css 代碼更清𥇦。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br><span class="line" data-line-number="6"></span><br><span class="line" data-line-number="7"></span><br><span class="line" data-line-number="8"></span><br><span class="line" data-line-number="9"></span><br><span class="line" data-line-number="10"></span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.sticky</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">5000</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.sticky</span> + <span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">92px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br><span class="line" data-line-number="6"></span><br><span class="line" data-line-number="7"></span><br><span class="line" data-line-number="8"></span><br><span class="line" data-line-number="9"></span><br><span class="line" data-line-number="10"></span><br><span class="line" data-line-number="11"></span><br><span class="line" data-line-number="12"></span><br><span class="line" data-line-number="13"></span><br><span class="line" data-line-number="14"></span><br><span class="line" data-line-number="15"></span><br><span class="line" data-line-number="16"></span><br><span class="line" data-line-number="17"></span><br><span class="line" data-line-number="18"></span><br><span class="line" data-line-number="19"></span><br><span class="line" data-line-number="20"></span><br><span class="line" data-line-number="21"></span><br></pre></td><td class="code"><pre><span class="line">initSticky();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">initSticky</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Get the header</span></span><br><span class="line">  <span class="keyword">let</span> header = <span class="built_in">document</span>.getElementById(<span class="string">"header"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Get the offset position of the navbar</span></span><br><span class="line">  <span class="keyword">let</span> sticky = header.offsetTop;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">stickyCheck</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">window</span>.pageYOffset &gt; sticky) &#123;</span><br><span class="line">      header.classList.add(<span class="string">"sticky"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      header.classList.remove(<span class="string">"sticky"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">window</span>.onscroll = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    stickyCheck()</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方案二：不兼容IE"><a href="#方案二：不兼容IE" class="headerlink" title="方案二：不兼容IE"></a>方案二：不兼容IE</h3><p>直接在本來的 header 把position: fixed改成 sticky 和 top: 0. Javascript 可以去掉</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.header</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: sticky;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">5000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;方案一：兼容IE&quot;&gt;&lt;a href=&quot;#方案一：兼容IE&quot; class=&quot;headerlink&quot; title=&quot;方案一：兼容IE&quot;&gt;&lt;/a&gt;方案一：兼容IE&lt;/h3&gt;&lt;p&gt;這個方案並不完美，position: fixed 太多坑，如果有有別一個 position:
      
    
    </summary>
    
      <category term="Front-end" scheme="https://blog.sukitsuki.com/categories/Front-end/"/>
    
      <category term="CSS" scheme="https://blog.sukitsuki.com/categories/Front-end/CSS/"/>
    
    
  </entry>
  
  <entry>
    <title>使用CDN把Shadowsocks主機的實體IP隱藏</title>
    <link href="https://blog.sukitsuki.com/2018/11/29/%E4%BD%BF%E7%94%A8CDN%E6%8A%8ASS%E4%B8%BB%E6%A9%9F%E7%9A%84%E5%AF%A6%E9%AB%94IP%E9%9A%B1%E8%97%8F/"/>
    <id>https://blog.sukitsuki.com/2018/11/29/使用CDN把SS主機的實體IP隱藏/</id>
    <published>2018-11-29T11:06:02.000Z</published>
    <updated>2018-11-29T12:51:52.012Z</updated>
    
    <content type="html"><![CDATA[<p>一般Shadowsocks 機場，直接到服務器的真實IP，這種VPS服務器的IP 段都是連著的，出較出名的VPS服務商的IP 段很易被掃出來，之後被各種DDOS或暴力破解。</p><p>使用CDN反代就可以把IP 隱藏起來，也可以把被GFW 封了的IP 段機器再利用。別外加上Nginx 反代可以把Shadowsocks 偽裝成網站頁面，或跳轉到別的頁面。</p><h3 id="Shadowsocks-配置"><a href="#Shadowsocks-配置" class="headerlink" title="Shadowsocks 配置"></a>Shadowsocks 配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br></pre></td><td class="code"><pre><span class="line">ss-server -s 0.0.0.0 -p 8080 -c config.json --fast-open --plugin obfs-server --plugin-opts <span class="string">"obfs=http"</span></span><br></pre></td></tr></table></figure><p>Ps: obfs使用 http 不要使用 tls，因為CDN 的https會做了別一重的tls封裝，引致解密失敗。</p><blockquote><p>Cloudflare 支持直接的端口</p></blockquote><p><code>80, 8080, 8880, 2052, 2082, 2086, 2095</code></p><p><del>如果使用 Cloudflare 強制 https/tls, 可以在page rules 把需使用的域名加入例外規則。</del></p><p>在 Cloudflare 上需要在 Crypto 關閉 Always Use HTTPS，不然 http 流量會強制跳到 https</p><p>如果使用Nginx 作為反代過濾，可以把非 SS連接跳轉到別的頁面</p><h3 id="Nginx-配置"><a href="#Nginx-配置" class="headerlink" title="Nginx 配置"></a>Nginx 配置</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br><span class="line" data-line-number="6"></span><br><span class="line" data-line-number="7"></span><br><span class="line" data-line-number="8"></span><br><span class="line" data-line-number="9"></span><br><span class="line" data-line-number="10"></span><br><span class="line" data-line-number="11"></span><br><span class="line" data-line-number="12"></span><br><span class="line" data-line-number="13"></span><br><span class="line" data-line-number="14"></span><br><span class="line" data-line-number="15"></span><br><span class="line" data-line-number="16"></span><br><span class="line" data-line-number="17"></span><br><span class="line" data-line-number="18"></span><br><span class="line" data-line-number="19"></span><br><span class="line" data-line-number="20"></span><br><span class="line" data-line-number="21"></span><br><span class="line" data-line-number="22"></span><br><span class="line" data-line-number="23"></span><br><span class="line" data-line-number="24"></span><br><span class="line" data-line-number="25"></span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">map</span> <span class="variable">$http_upgrade</span> <span class="variable">$connection_upgrade</span> &#123;</span><br><span class="line">    <span class="attribute">default</span> upgrade;</span><br><span class="line">    ''      close;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">ssl_protocols</span>       TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span>         HIGH:!aNULL:!MD5;</span><br><span class="line">    <span class="attribute">server_name</span>         __server_name__;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_redirect</span>      <span class="literal">off</span>;</span><br><span class="line">        <span class="attribute">proxy_http_version</span>  <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span>    Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span>    Connection <span class="variable">$connection_upgrade</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span>    Host <span class="variable">$http_host</span>;</span><br><span class="line">        <span class="attribute">if</span> (<span class="variable">$http_upgrade</span> = <span class="string">"websocket"</span>)&#123;</span><br><span class="line">            <span class="attribute">proxy_pass</span>          http://192.168.0.118:10000;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="attribute">if</span> (<span class="variable">$scheme</span> = <span class="string">"http"</span>)&#123;</span><br><span class="line">            <span class="attribute">return</span> <span class="number">301</span> https://<span class="variable">$http_host</span><span class="variable">$request_uri</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果使用Nginx 反代，Andorid 的 simple-obfs 的版本使用的 obfs-local 是0.0.2 對 websocket的支持不完整。</p><p>需要更新到最新版本的 obfs-local</p><p><a href="https://github.com/Tsuki/simple-obfs-android/releases/download/0.0.6/obfs-local-release.apk" target="_blank" rel="noopener">https://github.com/Tsuki/simple-obfs-android/releases/download/0.0.6/obfs-local-release.apk</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;一般Shadowsocks 機場，直接到服務器的真實IP，這種VPS服務器的IP 段都是連著的，出較出名的VPS服務商的IP 段很易被掃出來，之後被各種DDOS或暴力破解。&lt;/p&gt;
&lt;p&gt;使用CDN反代就可以把IP 隱藏起來，也可以把被GFW 封了的IP 段機器再利用。別外
      
    
    </summary>
    
      <category term="Server" scheme="https://blog.sukitsuki.com/categories/Server/"/>
    
    
  </entry>
  
  <entry>
    <title>在PostgresSQL啟用不區分大小寫欄位</title>
    <link href="https://blog.sukitsuki.com/2018/10/15/%E5%9C%A8PostgresSQL%E5%95%9F%E7%94%A8%E4%B8%8D%E5%8D%80%E5%88%86%E5%A4%A7%E5%B0%8F%E5%AF%AB%E6%AC%84%E4%BD%8D/"/>
    <id>https://blog.sukitsuki.com/2018/10/15/在PostgresSQL啟用不區分大小寫欄位/</id>
    <published>2018-10-15T17:53:24.000Z</published>
    <updated>2018-10-15T16:31:00.862Z</updated>
    
    <content type="html"><![CDATA[<p>在PostgreSQL 上建立欄位約束，是很簡單的事情，</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> (  </span><br><span class="line">  <span class="keyword">id</span>     <span class="keyword">uuid</span> PRIMARY <span class="keyword">KEY</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> uuid_generate_v4(),</span><br><span class="line">  email  <span class="built_in">text</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>我們只需要在表的欄位上加入唯一約束就可以，如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> email_unique <span class="keyword">UNIQUE</span> (email);</span><br></pre></td></tr></table></figure><p>但在特殊情況下，我們需要不區分大少寫的欄位，比如用戶表等。。。剛剛那種約速方法就不再有效，因為PostgreSQL 預設是大小寫區分的。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br><span class="line" data-line-number="6"></span><br><span class="line" data-line-number="7"></span><br><span class="line" data-line-number="8"></span><br><span class="line" data-line-number="9"></span><br><span class="line" data-line-number="10"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> (email) <span class="keyword">VALUES</span> (<span class="string">'test@example.com'</span>);  </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> (email) <span class="keyword">VALUES</span> (<span class="string">'TEST@example.com'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">from</span> <span class="keyword">users</span>;</span><br><span class="line"></span><br><span class="line">                  id                  |      email       </span><br><span class="line"><span class="comment">--------------------------------------+------------------</span></span><br><span class="line"> ccfcddd2-bdc5-4cf4-9475-4171960e6262 | test@example.com</span><br><span class="line"> 431308b4-8df8-44c9-bed4-7c44cf4e1ec1 | TEST@example.com</span><br><span class="line">(2 rows)</span><br></pre></td></tr></table></figure><p>一般情況下，我們會使用 <code>Lower</code> 和 <code>ToLower</code>  建立唯一索引和尋找數據。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> emailunique_idx <span class="keyword">on</span> <span class="keyword">users</span> (<span class="keyword">LOWER</span>(email)); </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">LOWER</span>(email) = <span class="keyword">LOWER</span>(?);</span><br></pre></td></tr></table></figure><p>但這種做法，忘了加 <code>LOWER</code> 就會令程序產生 Bug.</p><p>其實 PostgreSQL 供提不少額外的模塊，只是沒有預設啟用。這裹說的 <code>CITEXT</code> 就是其中一個。<code>CITEXT</code> 顧名思義就是 <code>case insensitive text</code>。</p><p>首先在 PostgreSQL 啟用額外的<code>CITEXT</code>模組。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> EXTENSION <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> citext;</span><br></pre></td></tr></table></figure><p>之後清空之前加入的數據，並修改 <code>email</code> 欄位屬情為 <code>citext</code>.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> RESTART <span class="keyword">IDENTITY</span> RESTRICT;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> email <span class="keyword">TYPE</span> citext;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> <span class="keyword">INDEX</span> emailunique_idx <span class="keyword">on</span> <span class="keyword">users</span> (email);</span><br></pre></td></tr></table></figure><p>之後再一次插入用戶數據，就可以看到樣同 <code>email</code> 並不能成功加入，並抛出錯誤。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> (email) <span class="keyword">VALUES</span> (<span class="string">'test@example.com'</span>);  </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span> (email) <span class="keyword">VALUES</span> (<span class="string">'TEST@example.com'</span>);</span><br><span class="line"></span><br><span class="line">ERROR:  duplicate key value violates unique constraint "email_unique"  </span><br><span class="line">DETAIL:  Key (email)=(TEST@example.com) already exists.</span><br></pre></td></tr></table></figure><p>這種做法的好處是，欄位中己配置好檢查，不需要在代碼中每一次手動加上檢查，在數據庫的欄位上作出最後一道防線。別一方面，其他開發人員看到表的 <code>DDL</code> 時就明白這個欄位是不區分大少寫。</p><p>最後這個模組是從 <code>PostgreSQL 9.3</code> 開始提供。</p><p>Ref: <a href="http://shuber.io/case-insensitive-unique-constraints-in-postgres/" target="_blank" rel="noopener">http://shuber.io/case-insensitive-unique-constraints-in-postgres/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在PostgreSQL 上建立欄位約束，是很簡單的事情，&lt;/p&gt;
&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot; data-line-number=&quot;1&quot;
      
    
    </summary>
    
      <category term="SQL" scheme="https://blog.sukitsuki.com/categories/SQL/"/>
    
    
  </entry>
  
  <entry>
    <title>升級到macOS Mojave</title>
    <link href="https://blog.sukitsuki.com/2018/10/01/%E5%8D%87%E7%B4%9A%E5%88%B0macOS-Mojave/"/>
    <id>https://blog.sukitsuki.com/2018/10/01/升級到macOS-Mojave/</id>
    <published>2018-10-01T17:56:53.000Z</published>
    <updated>2018-10-01T10:07:37.100Z</updated>
    
    <content type="html"><![CDATA[<p>今天把筆記本升級到 Mojave，有Dark theme 看起來舒服多了，雖然還有部分軟件不支持。</p><p>這次升級需時有點久，升了近一小時。而且升級後把 CommandLineTool刪了，需要重新下載。</p><p><code>sudo xcode-select --install</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;今天把筆記本升級到 Mojave，有Dark theme 看起來舒服多了，雖然還有部分軟件不支持。&lt;/p&gt;
&lt;p&gt;這次升級需時有點久，升了近一小時。而且升級後把 CommandLineTool刪了，需要重新下載。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo xcode-select
      
    
    </summary>
    
      <category term="日記" scheme="https://blog.sukitsuki.com/categories/%E6%97%A5%E8%A8%98/"/>
    
    
  </entry>
  
  <entry>
    <title>Casbin-訪問權限控制工具</title>
    <link href="https://blog.sukitsuki.com/2018/09/26/casbin-%E8%A8%AA%E5%95%8F%E6%AC%8A%E9%99%90%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7/"/>
    <id>https://blog.sukitsuki.com/2018/09/26/casbin-訪問權限控制工具/</id>
    <published>2018-09-26T20:51:25.000Z</published>
    <updated>2018-09-27T13:08:43.994Z</updated>
    
    <content type="html"><![CDATA[<p>Casbin 本質是一個配對的權限的工具庫，主要是由 model 模型和 policy 政策組成，</p><p>model example</p><p>r 是接受傳入的參數並定義欄位，例子中接受三項參數</p><p>p 是解析 Prolicy 內容並定義欄位</p><p>m 是配對 Policy 方式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br><span class="line" data-line-number="6"></span><br><span class="line" data-line-number="7"></span><br><span class="line" data-line-number="8"></span><br><span class="line" data-line-number="9"></span><br><span class="line" data-line-number="10"></span><br><span class="line" data-line-number="11"></span><br></pre></td><td class="code"><pre><span class="line">[request_definition]</span><br><span class="line">r = sub, obj, act</span><br><span class="line"></span><br><span class="line">[policy_definition]</span><br><span class="line">p = sub, obj, act</span><br><span class="line"></span><br><span class="line">[policy_effect]</span><br><span class="line">e = some(where (p.eft == allow))</span><br><span class="line"></span><br><span class="line">[matchers]</span><br><span class="line">m = (p.sub in r.sub || p.sub == &quot;*&quot;) &amp;&amp; keyMatch(r.obj, p.obj) &amp;&amp; (r.act == p.act || p.act == &quot;*&quot;)</span><br></pre></td></tr></table></figure><p>policy example </p><p>ps:雖然是csv格式 但需要在逗號後留空白，別外內容的空白是會保留，不要因為對齊而加padding</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br></pre></td><td class="code"><pre><span class="line">p, *, /info, GET</span><br><span class="line">p, user, /users, GET</span><br><span class="line">p, user, /users, POST</span><br><span class="line">p, setting, /settings, *</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Casbin 本質是一個配對的權限的工具庫，主要是由 model 模型和 policy 政策組成，&lt;/p&gt;
&lt;p&gt;model example&lt;/p&gt;
&lt;p&gt;r 是接受傳入的參數並定義欄位，例子中接受三項參數&lt;/p&gt;
&lt;p&gt;p 是解析 Prolicy 內容並定義欄位&lt;/p&gt;

      
    
    </summary>
    
      <category term="Golang" scheme="https://blog.sukitsuki.com/categories/Golang/"/>
    
    
  </entry>
  
  <entry>
    <title>刪了Xcode後不能使用make等指令</title>
    <link href="https://blog.sukitsuki.com/2018/09/24/%E5%88%AA%E4%BA%86xcode%E5%BE%8C%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8make%E7%AD%89%E6%8C%87%E4%BB%A4/"/>
    <id>https://blog.sukitsuki.com/2018/09/24/刪了xcode後不能使用make等指令/</id>
    <published>2018-09-24T17:43:26.000Z</published>
    <updated>2018-09-27T13:08:43.994Z</updated>
    
    <content type="html"><![CDATA[<p>如果出現以下內容</p><blockquote><p>xcrun: error: active developer path (“/Applications/Xcode.app/Contents/Developer”) does not exist</p></blockquote><p>輸入 <code>sudo xcode-select -s /Library/Developer/CommandLineTools</code> 改回使用 CommandLineTools 的路徑</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;如果出現以下內容&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;xcrun: error: active developer path (“/Applications/Xcode.app/Contents/Developer”) does not exist&lt;/p&gt;
&lt;/bloc
      
    
    </summary>
    
      <category term="ops" scheme="https://blog.sukitsuki.com/categories/ops/"/>
    
    
  </entry>
  
  <entry>
    <title>前端好用的模糊搜索工具</title>
    <link href="https://blog.sukitsuki.com/2018/09/21/%E5%89%8D%E7%AB%AF%E5%A5%BD%E7%94%A8%E7%9A%84%E6%A8%A1%E7%B3%8A%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/"/>
    <id>https://blog.sukitsuki.com/2018/09/21/前端好用的模糊搜索工具/</id>
    <published>2018-09-21T17:55:43.000Z</published>
    <updated>2018-09-21T10:25:31.993Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/krisk/fuse" target="_blank" rel="noopener">https://github.com/krisk/fuse</a></p><p><a href="http://fusejs.io/" target="_blank" rel="noopener">http://fusejs.io/</a></p><p>在處理表單的全文搜索，很常都要對不同欄位過濾，用了Fuse.js就可以少寫很多代碼。</p><p>Fuse.js 除了支持指定欄位/嵌套 Json，還支持比重搜索和 Bitap 算法提供一定近似匹配的功能。</p><p><a href="http://fusejs.io/#examples" target="_blank" rel="noopener">http://fusejs.io/#examples</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://github.com/krisk/fuse&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/krisk/fuse&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://fusejs.io
      
    
    </summary>
    
      <category term="Front-end" scheme="https://blog.sukitsuki.com/categories/Front-end/"/>
    
      <category term="JavaScript" scheme="https://blog.sukitsuki.com/categories/Front-end/JavaScript/"/>
    
    
  </entry>
  
  <entry>
    <title>SQL語法中的過濾方法</title>
    <link href="https://blog.sukitsuki.com/2018/09/20/SQL%E8%AA%9E%E6%B3%95%E4%B8%AD%E7%9A%84%E9%81%8E%E6%BF%BE%E6%96%B9%E6%B3%95/"/>
    <id>https://blog.sukitsuki.com/2018/09/20/SQL語法中的過濾方法/</id>
    <published>2018-09-20T20:17:49.000Z</published>
    <updated>2018-09-20T12:58:44.135Z</updated>
    
    <content type="html"><![CDATA[<p>在統計系統中，很常用到不同維度的分類和過澽，</p><p>比如按類加總/平均等等</p><table><thead><tr><th>Id</th><th>Gender</th><th>Salary</th><th>Country</th><th>Position</th><th>Status</th></tr></thead><tbody><tr><td>1</td><td>M</td><td>1000</td><td>China</td><td>Software</td><td>working</td></tr><tr><td>2</td><td>F</td><td>2000</td><td>USA</td><td>Software</td><td>holiday</td></tr><tr><td>3</td><td>M</td><td>5000</td><td>UK</td><td>Hardware</td><td>holiday</td></tr><tr><td>4</td><td>F</td><td>4000</td><td>Germany</td><td>Hardware</td><td>working</td></tr><tr><td>5</td><td>M</td><td>5000</td><td>USA</td><td>Admin</td><td>holiday</td></tr><tr><td>6</td><td>F</td><td>4000</td><td>Germany</td><td>Admin</td><td>holiday</td></tr></tbody></table><p>如果在上要一次過找出Admin和非Admin人員的平均Salary可以在 SQL中用 filter 或 case</p><p>PostgreSQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(salary) filter (<span class="keyword">where</span> <span class="keyword">position</span> = <span class="string">'admin'</span>)  <span class="keyword">as</span> admin_avg_salary,</span><br><span class="line">       <span class="keyword">avg</span>(salary) filter (<span class="keyword">where</span> <span class="keyword">position</span> &lt;&gt; <span class="string">'admin'</span>) <span class="keyword">as</span> non_admin_avg_salary</span><br><span class="line"><span class="keyword">from</span> raw_data</span><br></pre></td></tr></table></figure><p>MySQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br><span class="line" data-line-number="6"></span><br><span class="line" data-line-number="7"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">avg</span>(salary <span class="keyword">CASE</span></span><br><span class="line">                    <span class="keyword">WHEN</span> <span class="keyword">position</span> = <span class="string">'admin'</span> <span class="keyword">THEN</span> salary</span><br><span class="line">                    <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">as</span> admin_avg_salary,</span><br><span class="line">       <span class="keyword">avg</span>(salary <span class="keyword">CASE</span></span><br><span class="line">                    <span class="keyword">WHEN</span> <span class="keyword">position</span> &lt;&gt; <span class="string">'admin'</span> <span class="keyword">THEN</span> salary</span><br><span class="line">                    <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">as</span> non_admin_avg_salary</span><br><span class="line"><span class="keyword">from</span> raw_data</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在統計系統中，很常用到不同維度的分類和過澽，&lt;/p&gt;
&lt;p&gt;比如按類加總/平均等等&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Id&lt;/th&gt;
&lt;th&gt;Gender&lt;/th&gt;
&lt;th&gt;Salary&lt;/th&gt;
&lt;th&gt;Country&lt;/th&gt;
&lt;th&gt;Posit
      
    
    </summary>
    
      <category term="SQL" scheme="https://blog.sukitsuki.com/categories/SQL/"/>
    
    
  </entry>
  
  <entry>
    <title>gorm兼容net.IP類</title>
    <link href="https://blog.sukitsuki.com/2018/08/29/gorm%E5%85%BC%E5%AE%B9net-IP%E9%A1%9E/"/>
    <id>https://blog.sukitsuki.com/2018/08/29/gorm兼容net-IP類/</id>
    <published>2018-08-29T12:04:38.000Z</published>
    <updated>2018-08-29T06:37:22.933Z</updated>
    
    <content type="html"><![CDATA[<p>首先 alias net.IP類到本地包，為之後實作方法。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> IP net.IP</span><br></pre></td></tr></table></figure><p>因為pg不能直接使用<code>[]byte</code>作為輸入，所以需要實作<code>Value()</code>令Gorm 能轉換成字串作為輸入。</p><p>先從自定義的 <code>IP</code> 類轉換回 <code>net.IP</code> 類，再用 <code>String()</code> 轉成字串。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a IP)</span> <span class="title">Value</span><span class="params">()</span> <span class="params">(driver.Value, error)</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> net.IP(a).String(), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 別外，由於從pg 內讀取出來的是 <code>[]unit8</code> 類，內部數據是 ASIIC 碼，所以先轉換成 byte合併成 Array 再轉成 string.</p><p> 最後用 net 庫內的 ParseIP 方法 轉成 IP 類，之後再 cast 成自定義的 IP 類 返回。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br><span class="line" data-line-number="6"></span><br><span class="line" data-line-number="7"></span><br><span class="line" data-line-number="8"></span><br><span class="line" data-line-number="9"></span><br><span class="line" data-line-number="10"></span><br><span class="line" data-line-number="11"></span><br><span class="line" data-line-number="12"></span><br><span class="line" data-line-number="13"></span><br><span class="line" data-line-number="14"></span><br><span class="line" data-line-number="15"></span><br><span class="line" data-line-number="16"></span><br><span class="line" data-line-number="17"></span><br><span class="line" data-line-number="18"></span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> IP net.IP</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *IP)</span> <span class="title">Scan</span><span class="params">(src <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">error</span></span> &#123;</span><br><span class="line"><span class="keyword">switch</span> x := src.(<span class="keyword">type</span>) &#123;</span><br><span class="line"><span class="keyword">case</span> []<span class="keyword">uint8</span>:</span><br><span class="line">*a = IP(net.ParseIP(<span class="keyword">string</span>(x)))</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line"><span class="keyword">case</span> <span class="literal">nil</span>:</span><br><span class="line">*a = <span class="literal">nil</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> fmt.Errorf(<span class="string">"pq: cannot convert %T to net.IP"</span>, src)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a IP)</span> <span class="title">Value</span><span class="params">()</span> <span class="params">(driver.Value, error)</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> net.IP(a).String(), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;首先 alias net.IP類到本地包，為之後實作方法。&lt;/p&gt;
&lt;figure class=&quot;highlight go&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot; data-line-number=&quot;1&quot;
      
    
    </summary>
    
      <category term="Golang" scheme="https://blog.sukitsuki.com/categories/Golang/"/>
    
    
  </entry>
  
  <entry>
    <title>Diablo2打寶</title>
    <link href="https://blog.sukitsuki.com/2018/08/28/Diablo2%E6%89%93%E5%AF%B6/"/>
    <id>https://blog.sukitsuki.com/2018/08/28/Diablo2打寶/</id>
    <published>2018-08-28T00:11:54.000Z</published>
    <updated>2018-08-27T16:39:02.018Z</updated>
    
    <content type="html"><![CDATA[<h3 id="刷刷刷"><a href="#刷刷刷" class="headerlink" title="刷刷刷"></a>刷刷刷</h3><p>在飛了三天槌子後，今天（27號），終於打了喬丹之石，而且還是連出兩粒。第二粒在最後一把出的，別外還刷到接近頂值的馬拉的萬花筒（19抗性），實在太令人高興了。</p><p>這兩天把裝備提升，先刷到撒卡蘭姆使者，再刷到橡樹之心符文，在崔凡特己經可以穩定刷下去，但秘密母牛關還是有點壓力，而且刷起來不太效率。</p><p>在刷了好喬丹後，之後的喬丹之石就可以拿來開地表暗黑破壞神，玩了這麼多年還沒打過這隻呢。</p><p>之後去刷無限符文好還是謎團符文好呢？</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;刷刷刷&quot;&gt;&lt;a href=&quot;#刷刷刷&quot; class=&quot;headerlink&quot; title=&quot;刷刷刷&quot;&gt;&lt;/a&gt;刷刷刷&lt;/h3&gt;&lt;p&gt;在飛了三天槌子後，今天（27號），終於打了喬丹之石，而且還是連出兩粒。第二粒在最後一把出的，別外還刷到接近頂值的馬拉的萬花筒（19抗
      
    
    </summary>
    
      <category term="遊戲" scheme="https://blog.sukitsuki.com/categories/%E9%81%8A%E6%88%B2/"/>
    
    
  </entry>
  
  <entry>
    <title>暗黑破壞神</title>
    <link href="https://blog.sukitsuki.com/2018/08/24/Diablo2/"/>
    <id>https://blog.sukitsuki.com/2018/08/24/Diablo2/</id>
    <published>2018-08-24T20:18:10.000Z</published>
    <updated>2018-08-24T12:51:55.780Z</updated>
    
    <content type="html"><![CDATA[<h4 id="暗黑破壞神-2"><a href="#暗黑破壞神-2" class="headerlink" title="暗黑破壞神 2"></a>暗黑破壞神 2</h4><p>這個快二十多年的遊戲，想到不今時今日還有不少人在玩，在YouTube 上還有不少人上傳/直播打寶。現在官服還在維護，今天六月時天梯還有重置，而且還有不少玩家在線。</p><h4 id="私服"><a href="#私服" class="headerlink" title="私服"></a>私服</h4><p>現在D2除了正服外，還有不少私服，這些私服各有特色，有些是和正服一樣，有些是PVP服，還有倍率服。對於沒有時間或想重投D2的懷舊玩家來說，是不錯的選擇。</p><h4 id="角色"><a href="#角色" class="headerlink" title="角色"></a>角色</h4><p>當年第一個玩的角色，沒記錯應該是死靈法師，那時覺得帶著一大隊小弟，在單人模式上會輕鬆。現實上死靈法師在地獄難度之前，難易度是滿低的。</p><p>其次玩的是法師吧，法師的傳送是D2打寶的關建，除非有迷團甲。但迷團是相當高級的符文組，當年我連眼光都沒合成過，更別說迷團，那時拿的只是双精神，而且得用塔盾的精神。</p><p>現在重玩一下私服，就先練了個祝槌聖騎。雖然不算最好用的角式，但是是最易上手和最安全的角色。</p><h4 id="最後"><a href="#最後" class="headerlink" title="最後"></a>最後</h4><p>不小心把黑吉德賣了啊！！！！好想要SOJ啊！！！我還沒打過地表和三王啊！！！！！</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;暗黑破壞神-2&quot;&gt;&lt;a href=&quot;#暗黑破壞神-2&quot; class=&quot;headerlink&quot; title=&quot;暗黑破壞神 2&quot;&gt;&lt;/a&gt;暗黑破壞神 2&lt;/h4&gt;&lt;p&gt;這個快二十多年的遊戲，想到不今時今日還有不少人在玩，在YouTube 上還有不少人上傳/直播打寶。現
      
    
    </summary>
    
      <category term="遊戲" scheme="https://blog.sukitsuki.com/categories/%E9%81%8A%E6%88%B2/"/>
    
    
  </entry>
  
  <entry>
    <title>Docker清理</title>
    <link href="https://blog.sukitsuki.com/2018/08/20/Docker%E6%B8%85%E7%90%86/"/>
    <id>https://blog.sukitsuki.com/2018/08/20/Docker清理/</id>
    <published>2018-08-20T20:01:56.000Z</published>
    <updated>2018-08-20T12:25:09.461Z</updated>
    
    <content type="html"><![CDATA[<h3 id="查看已使用空間"><a href="#查看已使用空間" class="headerlink" title="查看已使用空間"></a>查看已使用空間</h3><blockquote><p>docker system df</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line" data-line-number="1"></span><br><span class="line" data-line-number="2"></span><br><span class="line" data-line-number="3"></span><br><span class="line" data-line-number="4"></span><br><span class="line" data-line-number="5"></span><br></pre></td><td class="code"><pre><span class="line">TYPE                TOTAL               ACTIVE              SIZE                RECLAIMABLE</span><br><span class="line">Images              17                  15                  5.531GB             1.822GB (32%)</span><br><span class="line">Containers          20                  1                   251.6MB             212.2MB (84%)</span><br><span class="line">Local Volumes       42                  17                  1.09GB              174.5MB (16%)</span><br><span class="line">Build Cache         0                   0                   0B                  0B</span><br></pre></td></tr></table></figure><h3 id="清理空間"><a href="#清理空間" class="headerlink" title="清理空間"></a>清理空間</h3><p>Remove local volumes not used by at least one container - 沒有在使用的空間</p><blockquote><p>docker volume prune</p></blockquote><h3 id="清理容器"><a href="#清理容器" class="headerlink" title="清理容器"></a>清理容器</h3><p>Remove all stopped containers - 己停用的容器</p><blockquote><p>docker container prune</p></blockquote><h3 id="清理影像"><a href="#清理影像" class="headerlink" title="清理影像"></a>清理影像</h3><p>Remove dangling images - 沒有被tag的影像層</p><blockquote><p>docker image prune</p></blockquote><p>Remove images without at least one container associated - 沒有在使用的影像</p><blockquote><p>docker image prune -a</p></blockquote><h3 id="全面清理"><a href="#全面清理" class="headerlink" title="全面清理"></a>全面清理</h3><ul><li>Remove stopped containers - 己停用的容器</li><li>Remove networks not used by at least one container - 沒有容器連接的網絡</li><li>Remove dangling images - 沒有被tag</li><li>Remove build cache - 構建快取</li></ul><blockquote><p>docker system prune</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;查看已使用空間&quot;&gt;&lt;a href=&quot;#查看已使用空間&quot; class=&quot;headerlink&quot; title=&quot;查看已使用空間&quot;&gt;&lt;/a&gt;查看已使用空間&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;docker system df&lt;/p&gt;
&lt;/blockquote&gt;
&lt;f
      
    
    </summary>
    
      <category term="Ops" scheme="https://blog.sukitsuki.com/categories/Ops/"/>
    
    
  </entry>
  
  <entry>
    <title>不如意事十常八九</title>
    <link href="https://blog.sukitsuki.com/2018/08/18/%E4%B8%8D%E5%A6%82%E6%84%8F%E4%BA%8B%E5%8D%81%E5%B8%B8%E5%85%AB%E4%B9%9D/"/>
    <id>https://blog.sukitsuki.com/2018/08/18/不如意事十常八九/</id>
    <published>2018-08-18T11:29:01.000Z</published>
    <updated>2018-08-18T13:01:30.769Z</updated>
    
    <content type="html"><![CDATA[<h4 id="一個人"><a href="#一個人" class="headerlink" title="一個人"></a>一個人</h4><p>算下來己經一個人生活了四個月了，感覺習慣嗎？並沒有。</p><p>只有在其實地方生活過，才會知道以前的好。感覺生活上一直在開倒車，當經歷過低潮才懂得之前的美好。從來沒有想過以前的生活是多麽的幸褔，在新的地方，新的環境下生活並不是一件簡單的事情。</p><p>這裹的治安水平並不算太高，搶手機的事情聽到不少。在這邊生活的地方基本上就是公司，宿舍兩點一線。而生活水平還算過得去，公司的伙食雖然不怎麼樣，但周邊還是有點能吃的餐館，基本上中、日、泰、韓的也有，價錢上比香港低一點但低不了不多。</p><p>周邊能去的地方，基本上就周日到超市逛逛，補充一下生活用品。房間沒有電腦，以前在房間玩電腦的習慣己經成為過去。雖然買了一台任天堂 Switch，不過大多是單人遊戲為主，但玩太多的也會生厭。</p><h4 id="醉"><a href="#醉" class="headerlink" title="醉"></a>醉</h4><p><img src="/2018/08/18/不如意事十常八九/photo_2018-08-18_20-15-26.jpg" alt=""></p><p>如果醉可以忘記，可以解決，可以逃避問題，那是多麼好的事情。</p><blockquote><p>期盼抹去的哀愁  卻更加的愁  。</p></blockquote><p>可是醉了之後，只有宿醉，頭痛，胃痛等問題等著。</p><blockquote><p>即使昏醉  大概不想安睡 </p><p>回去不回去  同樣掃不走空虛</p><p>長島內苦澀太多  然後強裝甜蜜快樂</p></blockquote><p>以前喝的時候，都是和身邊的人互相吐嘈、互相吐苦水、互相談生活，現在喝酒更多是為了消磨時間，為醉而喝。畢竟同事不是朋友，很多說話還是不可能拿出來說。</p><blockquote><p>和摯友抱擁交頭  說理想追求</p><p>靜靜地醉臥在門口 陪他作戰的朋友  各有各溜走</p></blockquote><h4 id="夢"><a href="#夢" class="headerlink" title="夢"></a>夢</h4><p><img src="/2018/08/18/不如意事十常八九/photo_2018-08-18_20-39-12.jpg" alt=""></p><blockquote><p>或者當日也曾有火種 </p><p>但擔心去路其實不通 </p><p>然後大計跌入四維國度失蹤</p><p>就此捲入既定軌跡中 </p><p>天天照例運行在虛空 </p><p>像循序漸進等夠鐘 </p><p>是否甘心永遠被動</p></blockquote><p>待續。。。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;一個人&quot;&gt;&lt;a href=&quot;#一個人&quot; class=&quot;headerlink&quot; title=&quot;一個人&quot;&gt;&lt;/a&gt;一個人&lt;/h4&gt;&lt;p&gt;算下來己經一個人生活了四個月了，感覺習慣嗎？並沒有。&lt;/p&gt;
&lt;p&gt;只有在其實地方生活過，才會知道以前的好。感覺生活上一直在開倒車，
      
    
    </summary>
    
      <category term="日記" scheme="https://blog.sukitsuki.com/categories/%E6%97%A5%E8%A8%98/"/>
    
    
  </entry>
  
</feed>
