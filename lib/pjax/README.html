<h1 id="Pjax"><a href="#Pjax" class="headerlink" title="Pjax"></a>Pjax</h1><p><a href="https://travis-ci.org/MoOx/pjax"><img src="http://img.shields.io/travis/MoOx/pjax.svg" alt="Build Status"></a> <a href="https://github.com/MoOx/pjax/issues/63">@todo fix CI</a>.</p>
<blockquote>
<p>Easily enable fast Ajax navigation on any website (using pushState +  xhr)</p>
</blockquote>
<p>Pjax is <del>a jQuery plugin</del> <strong>a standalone JavaScript module</strong> that uses<br>ajax (XmlHttpRequest) and<br><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/API/DOM/Manipulating_the_browser_history">pushState()</a><br>to deliver a fast browsing experience.</p>
<p><em>It allow you to completely transform user experience of standard websites<br>(server side generated or static ones) to make them feel they browse an app.<br>Especially for user that have low bandwidth connection.</em></p>
<p><strong>No more full page reload. No more lots of HTTP request.</strong></p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p><a href="http://moox.io">You can see this running on my website</a>, with sexy CSS animations when switching pages.</p>
<h2 id="How-Pjax-works"><a href="#How-Pjax-works" class="headerlink" title="How Pjax works"></a>How Pjax works</h2><p>Pjax loads page using ajax &amp; updates the browser’s current url using pushState without reloading your page’s layout or any resources (js, css), giving a fast page load.<br><em>But under the hood, it’s just ONE http request with a pushState() call.</em><br>Obviously, for <a href="http://caniuse.com/#search=pushstate">browsers that don’t support pushState()</a> Pjax fully degrades (yeah, it doesn’t do anything at all).</p>
<p>It simply works with all permalinks &amp; can update all parts of the page you<br>want (including html metas, title, navigation state).</p>
<ul>
<li>It’s not limited to one container, like jQuery-Pjax is,</li>
<li>It fully support browser history (back &amp; forward buttons),</li>
<li>It <strong>will</strong> support keyboard browsing (@todo),</li>
<li>Automatically fallback to classic navigation for externals pages (thanks to Capitain Obvious help),</li>
<li>Automatically fallback to classic navigation for internals pages that will not have the appropriated DOM tree,</li>
<li>You can add pretty cool CSS transitions (animations) very easily.</li>
<li>It’s around 3kb (minified &amp; gzipped).</li>
</ul>
<h3 id="Under-the-hood"><a href="#Under-the-hood" class="headerlink" title="Under the hood"></a>Under the hood</h3><ul>
<li>It listen to every clicks on links <em>you want</em> (by default all of them),</li>
<li>When an internal link is clicked, Pjax grabs HTML from your server via ajax,</li>
<li>Pjax render pages DOM tree (without loading any resources - images, css, js…)</li>
<li>It check if all defined parts can be replaced:<ul>
<li>if page doesn’t suit requirement, classic navigation used,</li>
<li>if page suits requirement, Pjax does all defined DOM replacements</li>
</ul>
</li>
<li>Then, it updates the browser’s current url using pushState</li>
</ul>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Pjax is fully automatic. You won’t need to setup anything on the existing HTML.<br>You just need to designate some elements on your page that will be replaced when<br>you navigate your site.</p>
<p>Consider the following page.</p>
<pre><code class="html"><span class="meta">&lt;!doctype html&gt;</span>
<span class="tag">&lt;<span class="name">html</span>&gt;</span>
<span class="tag">&lt;<span class="name">head</span>&gt;</span>
  <span class="comment">&lt;!-- metas, title, styles, ... --&gt;</span>
<span class="tag">&lt;/<span class="name">head</span>&gt;</span>
<span class="tag">&lt;<span class="name">body</span>&gt;</span>
  <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"my-Header"</span>&gt;</span><span class="tag">&lt;<span class="name">nav</span>&gt;</span><span class="comment">&lt;!-- a .is-active is in there --&gt;</span><span class="tag">&lt;/<span class="name">nav</span>&gt;</span><span class="tag">&lt;/<span class="name">header</span>&gt;</span>
  <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"my-Content"</span>&gt;</span>
    Sha blah <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/blah "</span>&gt;</span>blah<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.
  <span class="tag">&lt;/<span class="name">section</span>&gt;</span>
  <span class="tag">&lt;<span class="name">aside</span> <span class="attr">class</span>=<span class="string">"my-Sidebar"</span>&gt;</span>Sidebar stuff<span class="tag">&lt;/<span class="name">aside</span>&gt;</span>
  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">"my-Footer"</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span>
  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"onDomReadystuff.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="xml"><span class="comment">&lt;!-- analytics --&gt;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
<span class="tag">&lt;/<span class="name">body</span>&gt;</span>
<span class="tag">&lt;/<span class="name">html</span>&gt;</span>
</code></pre>
<p>We want Pjax to grab the url <code>/blah</code> then replace <code>.my-Content</code> with whatever it gets back.<br>Oh and the <code>&lt;nav&gt;</code> (that contains a status marker somewhere) can be updated too (or stay the same, as you wish).<br>And also the <code>&lt;aside&gt;</code> please.<br>So we want to update <code>[&quot;.my-Header&quot;, &quot;.my-Content&quot;, &quot;.my-Sidebar&quot;]</code>, <strong>without reloading styles nor scripts</strong>.</p>
<p>We do this by telling Pjax to listen on <code>a</code> tags and use CSS selectors defined above (without forgetting minimal meta):</p>
<pre><code class="javascript"><span class="keyword">new</span> Pjax({ <span class="attr">selectors</span>: [<span class="string">"title"</span>, <span class="string">".my-Header"</span>, <span class="string">".my-Content"</span>, <span class="string">".my-Sidebar"</span>] })
</code></pre>
<p>Now when someone in a Pjax-compatible browser clicks “blah” the content of all selectors will be replaced with the one found in the “blah” content.</p>
<p><em>Magic! For real!</em> <strong>There is completely no need to do anything on server side!</strong></p>
<h2 id="Differences-with-jQuery-pjax"><a href="#Differences-with-jQuery-pjax" class="headerlink" title="Differences with jQuery-pjax"></a>Differences with <a href="https://github.com/defunkt/jquery-pjax">jQuery-pjax</a></h2><ul>
<li>No jQuery dependency,</li>
<li>Not limited to a container,</li>
<li>No server side requirements,</li>
<li>Works for CommonJS environment (browserify), AMD (RequireJS) or even globally,</li>
<li>Allow page transition with CSS animations,</li>
<li>Can be easily hacked since every method is public (so overridable)</li>
</ul>
<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>You can install pjax from <strong>npm</strong></p>
<pre><code class="shell"><span class="meta">$</span><span class="bash"> npm install pjax</span>
</code></pre>
<p>Or using <strong>bower</strong></p>
<pre><code class="shell"><span class="meta">$</span><span class="bash"> bower install pjax</span>
</code></pre>
<p>Pjax can obviously be downloaded directly.</p>
<h2 id="No-dependencies"><a href="#No-dependencies" class="headerlink" title="No dependencies"></a>No dependencies</h2><p><em>There is nothing you need. No jQuery or something.</em></p>
<h2 id="Compatibility"><a href="#Compatibility" class="headerlink" title="Compatibility"></a>Compatibility</h2><p>Pjax only works with <a href="http://caniuse.com/#search=pushstate">browsers that support the <code>history.pushState</code> API</a>.<br>When the API isn’t supported Pjax goes into fallback mode (it just does nothing).</p>
<p>To see if Pjax is actually supported by your browser, use <code>Pjax.isSupported()</code>.</p>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><h3 id="new-Pjax"><a href="#new-Pjax" class="headerlink" title="new Pjax()"></a><code>new Pjax()</code></h3><p>Let’s talk more about the most basic way to get started:</p>
<pre><code class="js"><span class="keyword">new</span> Pjax({
  elements: <span class="string">"a"</span>, <span class="comment">// default is "a[href], form[action]"</span>
  selectors: [<span class="string">"title"</span>, <span class="string">".my-Header"</span>, <span class="string">".my-Content"</span>, <span class="string">".my-Sidebar"</span>]
})
</code></pre>
<p>This will enable Pjax on all links and designate the part to replace using CSS selectors <code>&quot;title&quot;, &quot;.my-Header&quot;, &quot;.my-Content&quot;, &quot;.my-Sidebar&quot;</code>.</p>
<p>For some reason, you might want to just target some elements to apply Pjax behavior.<br>In that case, you can 2 differents things:</p>
<ul>
<li>use a custom selector like “a.js-Pjax” or “.js-Pjax a” depending on what you want.</li>
<li>override <code>Pjax.prototype.getElements</code> that just basically <code>querSelectorAll</code> the <code>elements</code> option. In this function you just need to return a <code>NodeList</code>.</li>
</ul>
<pre><code class="js"><span class="comment">// use case 1</span>
<span class="keyword">new</span> Pjax({ <span class="attr">elements</span>: <span class="string">"a.js-Pjax"</span> })


<span class="comment">// use case 2</span>
Pjax.prototype.getElements = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{
  <span class="keyword">return</span> <span class="built_in">document</span>.getElementsByClassName(<span class="string">".js-Pjax"</span>)
}

<span class="keyword">new</span> Pjax({})
</code></pre>
<p>When instanciating a <code>Pjax</code> object, you need to pass all options as an object:</p>
<h4 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h4><h5 id="elements-String-default-“a-href-form-action-”"><a href="#elements-String-default-“a-href-form-action-”" class="headerlink" title="elements (String, default “a[href], form[action]”)"></a><code>elements</code> (String, default “a[href], form[action]”)</h5><p>CSS Selector to use to retrieve links to apply Pjax</p>
<h5 id="selectors-Array-default-“title”-“-js-Pjax”"><a href="#selectors-Array-default-“title”-“-js-Pjax”" class="headerlink" title="selectors (Array, default [“title”, “.js-Pjax”])"></a><code>selectors</code> (Array, default [“title”, “.js-Pjax”])</h5><p>CSS Selectors to replace. If a query returns multiples items, it will just keep the index.</p>
<p>Example of what you can do:</p>
<pre><code class="html"><span class="meta">&lt;!doctype html&gt;</span>
<span class="tag">&lt;<span class="name">html</span>&gt;</span>
<span class="tag">&lt;<span class="name">head</span>&gt;</span>
  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Page title<span class="tag">&lt;/<span class="name">title</span>&gt;</span>
<span class="tag">&lt;/<span class="name">head</span>&gt;</span>
<span class="tag">&lt;<span class="name">body</span>&gt;</span>
  <span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"js-Pjax"</span>&gt;</span><span class="tag">&lt;/<span class="name">header</span>&gt;</span>
  <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"js-Pjax"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">section</span>&gt;</span>
  <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">"my-Footer"</span>&gt;</span><span class="tag">&lt;/<span class="name">footer</span>&gt;</span>
  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">...</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
<span class="tag">&lt;/<span class="name">body</span>&gt;</span>
<span class="tag">&lt;/<span class="name">html</span>&gt;</span>
</code></pre>
<p>This example is correct and should work “as expected”.<br><em>If there is not the same amount of DOM element from current page and new page,<br>the Pjax behavior will fallback to normal page load.</em></p>
<h5 id="switches-Object-default"><a href="#switches-Object-default" class="headerlink" title="switches (Object, default {})"></a><code>switches</code> (Object, default {})</h5><p>Objects containing callbacks that can be used to switch old element with new element.<br>Keys should be one of the defined selector.</p>
<p>Examples:</p>
<pre><code class="js"><span class="keyword">new</span> Pjax({
  selectors: [<span class="string">"title"</span>, <span class="string">".Navbar"</span>, <span class="string">".js-Pjax"</span>],
  switches: {
    <span class="comment">// "title": Pjax.switches.outerHTML // default behavior</span>
    <span class="string">".Navbar"</span>: <span class="function"><span class="keyword">function</span>(<span class="params">oldEl, newEl, options</span>) </span>{
      <span class="comment">// here it's a stupid example since it's the default behavior too</span>
      oldEl.outerHTML = newEl.outerHTML
      <span class="keyword">this</span>.onSwitch()
    },

    <span class="string">".js-Pjax"</span>: Pjax.switches.sideBySide
  }
})
</code></pre>
<p>Callbacks are binded to Pjax instance itself to allow you to reuse it (ex: <code>this.onSwitch()</code>)</p>
<h6 id="Existing-switches-callback"><a href="#Existing-switches-callback" class="headerlink" title="Existing switches callback"></a>Existing switches callback</h6><ul>
<li><code>Pjax.switches.outerHTML</code>: default behavior, replace elements using outerHTML</li>
<li><code>Pjax.switches.innerHTML</code>: replace elements using innerHTML &amp; copy className too</li>
<li><code>Pjax.switches.sideBySide</code>: smart replacement that allow you to have both elements in the same parent when you want to use CSS animations. Old elements are removed when all childs have been fully animated (<a href="http://www.w3.org/TR/css3-animations/#animationend">animationEnd</a> event triggered)</li>
</ul>
<h6 id="Create-a-switch-callback"><a href="#Create-a-switch-callback" class="headerlink" title="Create a switch callback"></a>Create a switch callback</h6><p>Your function can do whatever you want, but you need to:</p>
<ul>
<li>replace oldEl content by newEl content in some fashion</li>
<li>call <code>this.onSwitch()</code> to trigger attached callback.</li>
</ul>
<p>Here is the default behavior as example</p>
<pre><code class="js"><span class="function"><span class="keyword">function</span>(<span class="params">oldEl, newEl, pjaxRequestOptions, switchesClasses</span>) </span>{
  oldEl.outerHTML = newEl.outerHTML
  <span class="keyword">this</span>.onSwitch()
}
</code></pre>
<h5 id="switchesOptions-Object-default"><a href="#switchesOptions-Object-default" class="headerlink" title="switchesOptions (Object, default {})"></a><code>switchesOptions</code> (Object, default {})</h5><p>This are options that can be used during switch by switchers ( for now, only <code>Pjax.switches.sideBySide</code> use it).<br>Very convenient when you use something like <a href="https://github.com/daneden/animate.css">Animate.css</a><br>with or without <a href="https://github.com/matthieua/WOW">WOW.js</a>.</p>
<pre><code class="js"><span class="keyword">new</span> Pjax({
  selectors: [<span class="string">"title"</span>, <span class="string">".js-Pjax"</span>],
  switches: {
    <span class="string">".js-Pjax"</span>: Pjax.switches.sideBySide
  },
  switchesOptions: {
    <span class="string">".js-Pjax"</span>: {
      classNames: {
        <span class="comment">// class added on the element that will be removed</span>
        remove: <span class="string">"Animated Animated--reverse Animate--fast Animate--noDelay"</span>,
        <span class="comment">// class added on the element that will be added</span>
        add: <span class="string">"Animated"</span>,
        <span class="comment">// class added on the element when it go backward</span>
        backward: <span class="string">"Animate--slideInRight"</span>,
        <span class="comment">// class added on the element when it go forward (used for new page too)</span>
        forward: <span class="string">"Animate--slideInLeft"</span>
      },
      callbacks: {
        <span class="comment">// to make a nice transition with 2 pages as the same time</span>
        <span class="comment">// we are playing with absolute positioning for element we are removing</span>
        <span class="comment">// &amp; we need live metrics to have something great</span>
        <span class="comment">// see associated CSS below</span>
        removeElement: <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>{
          el.style.marginLeft = <span class="string">"-"</span> + (el.getBoundingClientRect().width/<span class="number">2</span>) + <span class="string">"px"</span>
        }
      }
    }
  }
})
</code></pre>
<p><em>Note that remove class include <code>Animated--reverse</code> which is a simple way to not have<br>to create duplicate transition for (slideIn + reverse =&gt; slideOut).</em></p>
<p>The following CSS will be required to make something nice</p>
<pre><code class="css"><span class="comment">/*</span>
<span class="comment">  if your content elements doesn't have a fixed width,</span>
<span class="comment">  you can get issue when absolute positioning will be used</span>
<span class="comment">  so you will need that rules</span>
<span class="comment">*/</span>
<span class="selector-class">.js-Pjax</span> { <span class="attribute">position</span>: relative } <span class="comment">/* parent element where switch will be made */</span>

  <span class="selector-class">.js-Pjax-child</span> { <span class="attribute">width</span>: <span class="number">100%</span> }

  <span class="comment">/* position for the elements that will be removed */</span>
  <span class="selector-class">.js-Pjax-remove</span> {
    <span class="attribute">position</span>: absolute;
    <span class="attribute">left</span>: <span class="number">50%</span>;
    <span class="comment">/* transform: translateX(-50%) */</span>
    <span class="comment">/* transform can't be used since we already use generic translate for the remove effect (eg animate.css) */</span>
    <span class="comment">/* margin-left: -width/2; // made with js */</span>
    <span class="comment">/* you can totally drop the margin-left thing from switchesOptions if you use custom animations */</span>
  }

<span class="comment">/* CSS animations */</span>
<span class="selector-class">.Animated</span> {
  <span class="attribute">animation-fill-mode</span>: both;
  <span class="attribute">animation-duration</span>: <span class="number">1s</span>;
}

  <span class="selector-class">.Animated--reverse</span> { <span class="attribute">animation-direction</span>: reverse }

  <span class="selector-class">.Animate--fast</span> { <span class="attribute">animation-duration</span>: .<span class="number">5s</span> }
  <span class="selector-class">.Animate--noDelay</span> { <span class="attribute">animation-delay</span>: <span class="number">0s</span> <span class="meta">!important</span>;  }

  <span class="selector-class">.Animate--slideInRight</span> { <span class="attribute">animation-name</span>: Animation-slideInRight }
  @<span class="keyword">keyframes</span> Animation-slideInRight {
    0% {
      <span class="attribute">opacity</span>: <span class="number">0</span>;
      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(100rem);
    }

    100% {
      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(0);
    }
  }

  <span class="selector-class">.Animate--slideInLeft</span> { <span class="attribute">animation-name</span>: Animation-slideInLeft }
  @<span class="keyword">keyframes</span> Animation-slideInLeft {
    0% {
      <span class="attribute">opacity</span>: <span class="number">0</span>;
      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-100rem);
    }

    100% {
      <span class="attribute">transform</span>: <span class="built_in">translateX</span>(0);
    }
  }
</code></pre>
<p>To get understand this CSS, here is a HTML snippet</p>
<pre><code class="html"><span class="meta">&lt;!doctype html&gt;</span>
<span class="tag">&lt;<span class="name">html</span>&gt;</span>
<span class="tag">&lt;<span class="name">head</span>&gt;</span>
  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Page title<span class="tag">&lt;/<span class="name">title</span>&gt;</span>
<span class="tag">&lt;/<span class="name">head</span>&gt;</span>
<span class="tag">&lt;<span class="name">body</span>&gt;</span>
  <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"js-Pjax"</span>&gt;</span>
    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"js-Pjax-child"</span>&gt;</span>
      Your content here
    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>
    <span class="comment">&lt;!--</span>
<span class="comment">    when switching will be made you will have the following tree</span>
<span class="comment">    &lt;div class="js-Pjax-child js-Pjax-remove Animate..."&gt;</span>
<span class="comment">      Your OLD content here</span>
<span class="comment">    &lt;/div&gt;</span>
<span class="comment">    &lt;div class="js-Pjax-child js-Pjax-add Animate..."&gt;</span>
<span class="comment">      Your NEW content here</span>
<span class="comment">    &lt;/div&gt;</span>
<span class="comment">    --&gt;</span>
  <span class="tag">&lt;/<span class="name">section</span>&gt;</span>
  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">...</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
<span class="tag">&lt;/<span class="name">body</span>&gt;</span>
<span class="tag">&lt;/<span class="name">html</span>&gt;</span>
</code></pre>
<h5 id="history-Boolean-default-true"><a href="#history-Boolean-default-true" class="headerlink" title="history (Boolean, default true)"></a><code>history</code> (Boolean, default true)</h5><p>Enable pushState. Only disable if you are crazy.<br>Internaly, this option is used when <code>popstate</code> is used (to not pushState again).<br>You should forget that option.</p>
<h5 id="analytics-Function-default-to-a-function-that-push-gaq-trackPageview-or-send-ga-pageview"><a href="#analytics-Function-default-to-a-function-that-push-gaq-trackPageview-or-send-ga-pageview" class="headerlink" title="analytics (Function, default to a function that push _gaq trackPageview or send ga pageview"></a><code>analytics</code> (Function, default to a function that push <code>_gaq</code> <code>trackPageview</code> or send <code>ga</code> <code>pageview</code></h5><p>Function that allow you to add behavior for analytics. By default it try to track<br>a pageview with Google Analytics.<br>It’s called every time a page is switched, even for history buttons.</p>
<h5 id="scrollTo-Integer-default-to-0"><a href="#scrollTo-Integer-default-to-0" class="headerlink" title="scrollTo (Integer, default to 0)"></a><code>scrollTo</code> (Integer, default to 0)</h5><p>Value (in px) to scrollTo when a page is switched.</p>
<h5 id="cacheBust-Boolean-default-true"><a href="#cacheBust-Boolean-default-true" class="headerlink" title="cacheBust (Boolean, default true)"></a><code>cacheBust</code> (Boolean, default true)</h5><p>When set to true,<br>append a timestamp query string segment to the requested URLs<br>in order to skip browser cache.</p>
<h5 id="debug-Boolean-default-to-false"><a href="#debug-Boolean-default-to-false" class="headerlink" title="debug (Boolean, default to false)"></a><code>debug</code> (Boolean, default to false)</h5><p>Enable verbose mode &amp; doesn’t use fallback when there is an error.<br>Useful to debug page layout differences.</p>
<h5 id="currentUrlFullReload-Boolean-default-to-false"><a href="#currentUrlFullReload-Boolean-default-to-false" class="headerlink" title="currentUrlFullReload (Boolean, default to false)"></a><code>currentUrlFullReload</code> (Boolean, default to false)</h5><p>When set to true, clicking on a link that point the current url trigger a full page reload.</p>
<h3 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h3><p>Pjax fires a number of events regardless of how its invoked.</p>
<p>All events are fired from the <em>document</em>, not the link was clicked.</p>
<h4 id="Ajax-related-events"><a href="#Ajax-related-events" class="headerlink" title="Ajax related events"></a>Ajax related events</h4><ul>
<li><code>pjax:send</code> - Fired after the Pjax request begins.</li>
<li><code>pjax:complete</code> - Fired after the Pjax request finishes.</li>
<li><code>pjax:success</code> - Fired after the Pjax request succeeds.</li>
<li><code>pjax:error</code> - Fired after the Pjax request fails. Returning false will prevent the the fallback redirect.</li>
</ul>
<p><code>send</code> and <code>complete</code> are a good pair of events to use if you are implementing a loading indicator (eg: <a href="http://buunguyen.github.io/topbar/">topbar</a>)</p>
<pre><code class="js">$(<span class="built_in">document</span>).on(<span class="string">'pjax:send'</span>, topbar.show)
$(<span class="built_in">document</span>).on(<span class="string">'pjax:complete'</span>, topbar.hide)
</code></pre>
<h4 id="Note-about-DOM-ready-state"><a href="#Note-about-DOM-ready-state" class="headerlink" title="Note about DOM ready state"></a>Note about DOM ready state</h4><p>Most of the time, you have code attached &amp; related to the current DOM, that you only execute when page/dom is ready.<br>Since Pjax doesn’t magically rexecute you previous code each time you load a page, you need to make a simple thing to rexecute appropriate code:</p>
<pre><code class="js"><span class="function"><span class="keyword">function</span> <span class="title">whenDOMReady</span>(<span class="params"></span>) </span>{
  <span class="comment">// do you stuff</span>
}

whenDOMReady()

<span class="keyword">new</span> Pjax()

<span class="built_in">document</span>.addEventListener(<span class="string">"pjax:success"</span>, whenDOMReady)
</code></pre>
<p><em>Note: Don’t create the Pjax in the <code>whenDOMReady</code> function.</em></p>
<p>For my concern &amp; usage, I <code>js-Pjax</code>ify all body children, including stuff like navigation &amp; footer (to get navigation state easily updated).<br>So attached behavior are rexecuted each time a page is loaded, like in the snippet above.</p>
<p>If you want to just update a specific part (it’s totally a good idea), you can just<br>add the DOM related code in a function &amp; rexecute this function when “pjax:success” event is done.</p>
<pre><code class="js"><span class="comment">// do your global stuff</span>
<span class="comment">//... dom ready blah blah</span>

<span class="function"><span class="keyword">function</span> <span class="title">whenContainerReady</span>(<span class="params"></span>) </span>{
  <span class="comment">// do your container related stuff</span>
}
whenContainerReady()

<span class="keyword">new</span> Pjax()

<span class="built_in">document</span>.addEventListener(<span class="string">"pjax:success"</span>, whenContainerReady)
</code></pre>
<hr>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Q-Disqus-doesn’t-work-anymore-how-can-I-fix-that"><a href="#Q-Disqus-doesn’t-work-anymore-how-can-I-fix-that" class="headerlink" title="Q: Disqus doesn’t work anymore, how can I fix that ?"></a>Q: Disqus doesn’t work anymore, how can I fix that ?</h3><p>A: There is a few things you need to do:</p>
<ul>
<li>wrap your disqus snippet into a dom element that you will add to the <code>selector</code><br>arra (or just wrap it with class=”js-Pjax”) &amp; be sure to have a least the empty<br>wrapper on each page (to avoid differences of DOM between pages)</li>
<li>edit your disqus snippet like the one below</li>
</ul>
<h4 id="Disqus-snippet-before-pjax-integration"><a href="#Disqus-snippet-before-pjax-integration" class="headerlink" title="Disqus snippet before pjax integration"></a>Disqus snippet before pjax integration</h4><pre><code class="html"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span>
<span class="javascript">  <span class="keyword">var</span> disqus_shortname = <span class="string">'YOURSHORTNAME'</span></span>
<span class="javascript">  <span class="keyword">var</span> disqus_identifier = <span class="string">'PAGEID'</span></span>
<span class="javascript">  <span class="keyword">var</span> disqus_url = <span class="string">'PAGEURL'</span></span>
<span class="javascript">  <span class="keyword">var</span> disqus_script = <span class="string">'embed.js'</span></span>
<span class="javascript">  (<span class="function"><span class="keyword">function</span>(<span class="params">d,s</span>) </span>{</span>
<span class="javascript">  s = d.createElement(<span class="string">'script'</span>);s.async=<span class="number">1</span>;s.src = <span class="string">'//'</span> + disqus_shortname + <span class="string">'.disqus.com/'</span>+disqus_script;</span>
<span class="javascript">  (d.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>]).appendChild(s);</span>
<span class="javascript">  })(<span class="built_in">document</span>)</span>
<span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
</code></pre>
<h4 id="Disqus-snippet-after-Pjax-integration"><a href="#Disqus-snippet-after-Pjax-integration" class="headerlink" title="Disqus snippet after Pjax integration"></a>Disqus snippet after Pjax integration</h4><pre><code class="html"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"js-Pjax"</span>&gt;</span><span class="comment">&lt;!-- need to be here on every pjaxified page, even if empty --&gt;</span>
<span class="comment">&lt;!-- if (blah blah) { // eventual server side test to know wheter or not you include this script --&gt;</span>
  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span>
<span class="javascript">    <span class="keyword">var</span> disqus_shortname = <span class="string">'YOURSHORTNAME'</span></span>
<span class="javascript">    <span class="keyword">var</span> disqus_identifier = <span class="string">'PAGEID'</span></span>
<span class="javascript">    <span class="keyword">var</span> disqus_url = <span class="string">'PAGEURL'</span></span>
<span class="javascript">    <span class="keyword">var</span> disqus_script = <span class="string">'embed.js'</span></span>
<span class="undefined"></span>
<span class="javascript">    <span class="comment">// here we will only load the disqus &lt;script&gt; if not already loaded</span></span>
<span class="javascript">    <span class="keyword">if</span> (!<span class="built_in">window</span>.DISQUS) {</span>
<span class="javascript">      (<span class="function"><span class="keyword">function</span>(<span class="params">d,s</span>) </span>{</span>
<span class="javascript">      s = d.createElement(<span class="string">'script'</span>);s.async=<span class="number">1</span>;s.src = <span class="string">'//'</span> + disqus_shortname + <span class="string">'.disqus.com/'</span>+disqus_script;</span>
<span class="javascript">      (d.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>]).appendChild(s);</span>
<span class="javascript">      })(<span class="built_in">document</span>)</span>
<span class="undefined">    }</span>
<span class="javascript">    <span class="comment">// if disqus &lt;script&gt; already loaded, we just reset disqus the right way</span></span>
<span class="javascript">    <span class="comment">// see http://help.disqus.com/customer/portal/articles/472107-using-disqus-on-ajax-sites</span></span>
<span class="javascript">    <span class="keyword">else</span> {</span>
<span class="undefined">      DISQUS.reset({</span>
<span class="javascript">        reload: <span class="literal">true</span>,</span>
<span class="javascript">        config: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span>
<span class="javascript">          <span class="keyword">this</span>.page.identifier = disqus_identifier</span>
<span class="javascript">          <span class="keyword">this</span>.page.url = disqus_url</span>
<span class="undefined">        }</span>
<span class="undefined">      })</span>
<span class="undefined">    }</span>
<span class="undefined">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>
<span class="comment">&lt;!-- } --&gt;</span>
<span class="tag">&lt;/<span class="name">div</span>&gt;</span>
</code></pre>
<p><strong>Note: The thing you need to understand is that Pjax handle inline <code>&lt;script&gt;</code> only for container you are reloading.</strong></p>
<hr>
<h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><p>Clone this repository and run <code>npm run example</code>, then open <code>http://localhost:3000/example</code> in your browser.</p>
<hr>
<h2 id="CONTRIBUTING"><a href="#CONTRIBUTING" class="headerlink" title="CONTRIBUTING"></a>CONTRIBUTING</h2><ul>
<li>⇄ Pull requests and ★ Stars are always welcome.</li>
<li>For bugs and feature requests, please create an issue.</li>
<li>Pull requests must be accompanied by passing automated tests (<code>$ npm test</code>).</li>
</ul>
<h2 id="CHANGELOG"><a href="#CHANGELOG" class="headerlink" title="CHANGELOG"></a><a href="CHANGELOG.md">CHANGELOG</a></h2><h2 id="LICENSE"><a href="#LICENSE" class="headerlink" title="LICENSE"></a><a href="LICENSE">LICENSE</a></h2>